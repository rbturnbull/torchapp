

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Testing &mdash; torchapp 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Project Setup" href="setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            torchapp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Project Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#logistic-regression-app-example">Logistic Regression App Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#torchapptestcase-reference">TorchAppTestCase Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#torchapp.testing.TorchAppTestCase"><code class="docutils literal notranslate"><span class="pre">TorchAppTestCase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchapp.testing.TorchAppTestCase.get_app"><code class="docutils literal notranslate"><span class="pre">TorchAppTestCase.get_app()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchapp.testing.TorchAppTestCase.get_expected_dir"><code class="docutils literal notranslate"><span class="pre">TorchAppTestCase.get_expected_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchapp.testing.TorchAppTestCase.perform_subtests"><code class="docutils literal notranslate"><span class="pre">TorchAppTestCase.perform_subtests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchapp.testing.TorchAppTestCase.test_model"><code class="docutils literal notranslate"><span class="pre">TorchAppTestCase.test_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">torchapp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Testing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/testing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h1>
<p>Classes inheriting from <code class="docutils literal notranslate"><span class="pre">TorchApp</span></code> can be tested automatically by inheriting from the <code class="docutils literal notranslate"><span class="pre">TorchAppTestCase</span></code>.
This creates a number of automated tests designed to be used in conjunction with <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.
The expected results of the tests are definied in yaml files in a directory named <code class="docutils literal notranslate"><span class="pre">expected</span></code> next to the scripts with the testing code
and in a subdirectory with the class name which is an instance of <code class="docutils literal notranslate"><span class="pre">TorchAppTestCase</span></code>. Each test has its own subdirectory there.
There can be multiple expected files for testing the same method to test different combinations of arguments.
The format for the yaml files is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;...&quot;</span>
</pre></div>
</div>
<p>The params gives a list of keyword arguments for the TorchApp method being tested and the output is some data in a format required by the testing function.
For example the expected output for the model method is the string representation of the model definied by the params.</p>
<p>If you want to change the expected output for a test then run pytest with the <code class="docutils literal notranslate"><span class="pre">-s</span></code> option. This will find failing tests and prompt the user to ask if the expected file should be regenerated.
One way to automatically create expectation files is to add blank files and prompt for adding the expected result.
The resulting file should be read to make sure that it is correct.</p>
<section id="logistic-regression-app-example">
<h2>Logistic Regression App Example<a class="headerlink" href="#logistic-regression-app-example" title="Link to this heading"></a></h2>
<p>For instance, the LogisticRegression app included as an example in this project is tested as follows in <code class="docutils literal notranslate"><span class="pre">tests/test_logistic.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchapp.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchAppTestCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchapp.examples.logistic_regression</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegressionApp</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestLogisticRegressionApp</span><span class="p">(</span><span class="n">TorchAppTestCase</span><span class="p">):</span>
    <span class="n">app_class</span> <span class="o">=</span> <span class="n">LogisticRegressionApp</span>
</pre></div>
</div>
<p>The expected values for the tests are in <code class="docutils literal notranslate"><span class="pre">tests/expected/TestLogisticRegressionApp</span></code>.
The file for testing the model is in <code class="docutils literal notranslate"><span class="pre">tests/expected/TestLogisticRegressionApp/test_model/model.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Linear(in_features=1, out_features=1, bias=True)</span>
</pre></div>
</div>
</section>
<section id="torchapptestcase-reference">
<h2>TorchAppTestCase Reference<a class="headerlink" href="#torchapptestcase-reference" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="torchapp.testing.TorchAppTestCase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchapp.testing.</span></span><span class="sig-name descname"><span class="pre">TorchAppTestCase</span></span><a class="headerlink" href="#torchapp.testing.TorchAppTestCase" title="Link to this definition"></a></dt>
<dd><p>Automated tests for TorchApp classes</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchapp.testing.TorchAppTestCase.get_app">
<span class="sig-name descname"><span class="pre">get_app</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TorchApp</span></span></span><a class="headerlink" href="#torchapp.testing.TorchAppTestCase.get_app" title="Link to this definition"></a></dt>
<dd><p>Returns an instance of the app for this test case.</p>
<p>It instantiates an object from <cite>app_class</cite>.
Override <cite>app_class</cite> or this method so the correct app is returned from calling this method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchapp.testing.TorchAppTestCase.get_expected_dir">
<span class="sig-name descname"><span class="pre">get_expected_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#torchapp.testing.TorchAppTestCase.get_expected_dir" title="Link to this definition"></a></dt>
<dd><p>Returns the path to the directory where the expected files.</p>
<p>It creates the directory if it doesn’t already exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchapp.testing.TorchAppTestCase.perform_subtests">
<span class="sig-name descname"><span class="pre">perform_subtests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torchapp.testing.TorchAppTestCase.perform_subtests" title="Link to this definition"></a></dt>
<dd><p>Performs a number of subtests for a method on the app.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interactive</strong> (<em>bool</em>) – Whether or not the user should be prompted for creating or regenerating expected files.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the method to be tested with the string <cite>test_</cite> prepended to it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchapp.testing.TorchAppTestCase.test_model">
<span class="sig-name descname"><span class="pre">test_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torchapp.testing.TorchAppTestCase.test_model" title="Link to this definition"></a></dt>
<dd><p>Tests the method of a TorchApp to create a pytorch model.</p>
<p>The expected output is the string representation of the model created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interactive</strong> (<em>bool</em>) – Whether or not failed tests should prompt the user to regenerate the expected files.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup.html" class="btn btn-neutral float-left" title="Project Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Robert Turnbull.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>